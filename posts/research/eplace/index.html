<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>基于电势的解析布局 - Sivanlaai's Blog</title><meta name=author content="SivanLaai"><meta name=author-link content="https://www.laais.cn"><meta name=description content="基于电势的解析布局 基本概念 布局的定义 布局问题可以描述为一个超图问题，可以定义为如下： $$G = (V,E,R)$$ 其中$V$表示元器件（顶点）集合，$E$表示网表（"><meta name=keywords content="论文阅读"><meta itemprop=name content="基于电势的解析布局"><meta itemprop=description content="基于电势的解析布局 基本概念 布局的定义 布局问题可以描述为一个超图问题，可以定义为如下： $$G = (V,E,R)$$ 其中$V$表示元器件（顶点）集合，$E$表示网表（"><meta itemprop=datePublished content="2023-03-27T16:33:04+08:00"><meta itemprop=dateModified content="2023-03-27T21:44:11+08:00"><meta itemprop=wordCount content="3417"><meta itemprop=image content="https://www.laais.cn/avatar.png"><meta itemprop=keywords content="论文阅读,"><meta property="og:title" content="基于电势的解析布局"><meta property="og:description" content="基于电势的解析布局 基本概念 布局的定义 布局问题可以描述为一个超图问题，可以定义为如下： $$G = (V,E,R)$$ 其中$V$表示元器件（顶点）集合，$E$表示网表（"><meta property="og:type" content="article"><meta property="og:url" content="https://www.laais.cn/posts/research/eplace/"><meta property="og:image" content="https://www.laais.cn/avatar.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-27T16:33:04+08:00"><meta property="article:modified_time" content="2023-03-27T21:44:11+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.laais.cn/avatar.png"><meta name=twitter:title content="基于电势的解析布局"><meta name=twitter:description content="基于电势的解析布局 基本概念 布局的定义 布局问题可以描述为一个超图问题，可以定义为如下： $$G = (V,E,R)$$ 其中$V$表示元器件（顶点）集合，$E$表示网表（"><meta name=application-name content="Sivanlaai's blog"><meta name=apple-mobile-web-app-title content="Sivanlaai's blog"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://www.laais.cn/posts/research/eplace/><link rel=prev href=https://www.laais.cn/posts/research/read_paper/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"基于电势的解析布局","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.laais.cn\/posts\/research\/eplace\/"},"image":["https:\/\/www.laais.cn\/apple-touch-icon.png"],"genre":"posts","keywords":"论文阅读","wordcount":3417,"url":"https:\/\/www.laais.cn\/posts\/research\/eplace\/","datePublished":"2023-03-27T16:33:04+08:00","dateModified":"2023-03-27T21:44:11+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"SivanLaai","logo":"https:\/\/www.laais.cn\/avatar.png"},"author":{"@type":"Person","name":"SivanLaai"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title="Sivanlaai's Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/avatar.png data-srcset="/avatar.png, /avatar.png 1.5x, /avatar.png 2x" data-sizes=auto alt="Sivanlaai's Blog" title="Sivanlaai's Blog"><span class=header-title-text>SivanLaai's blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item>没有更多翻译</li></ul></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Sivanlaai's Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/avatar.png data-srcset="/avatar.png, /avatar.png 1.5x, /avatar.png 2x" data-sizes=auto alt=/avatar.png title=/avatar.png><span class=header-title-text>SivanLaai's blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item text-center"><a class=menu-link href=https://github.com/SivanLaai/blog title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw' aria-hidden=true></i></a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option disabled>没有更多翻译</option></select></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?aa4e404535364259553aa4bd8f89bb3a",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><main class=container data-page-style=custom><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>基于电势的解析布局</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://www.laais.cn title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class="lazyload avatar" src=/svg/loading.min.svg data-src="https://gravatar.loli.net/avatar/8fb4e47a8c0333cba9e66f2aa7592f10?s=32&amp;d=mp" data-srcset="https://gravatar.loli.net/avatar/8fb4e47a8c0333cba9e66f2aa7592f10?s=32&amp;d=mp, https://gravatar.loli.net/avatar/8fb4e47a8c0333cba9e66f2aa7592f10?s=32&amp;d=mp 1.5x, https://gravatar.loli.net/avatar/8fb4e47a8c0333cba9e66f2aa7592f10?s=32&amp;d=mp 2x" data-sizes=auto alt=SivanLaai title=SivanLaai>&nbsp;SivanLaai</a></span>
<span class=post-category>收录于 <a href=/categories/%E7%A0%94%E7%A9%B6/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 研究</a></span></div><div class=post-meta-line><span title="2023-03-27 16:33:04"><i class="fa-regular fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-03-27>2023-03-27</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw" aria-hidden=true></i> 约 3417 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw" aria-hidden=true></i> 预计阅读 7 分钟</span>&nbsp;<span class=comment-visitors data-flag-title=基于电势的解析布局>
<i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span data-path=/posts/research/eplace/ class=waline-pageview-count>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#基本概念>基本概念</a><ul><li><a href=#布局的定义>布局的定义</a></li><li><a href=#全局布局的定义>全局布局的定义</a><ul><li><a href=#线长平滑化>线长平滑化</a></li></ul></li><li><a href=#密度惩罚>密度惩罚</a></li><li><a href=#非线性布局优化方程>非线性布局优化方程</a></li></ul></li><li><a href=#静电系统建模edensity>静电系统建模（eDensity）</a><ul><li><a href=#静电平衡系统建模>静电平衡系统建模</a></li><li><a href=#密度惩罚和梯度>密度惩罚和梯度</a><ul><li><a href=#填充节点插入>填充节点插入</a></li></ul></li><li><a href=#暗节点插入>暗节点插入</a></li><li><a href=#密度缩放>密度缩放</a></li><li><a href=#势能计算>势能计算</a></li></ul></li><li><a href=#泊松方程>泊松方程</a></li></ul></nav></div></div><div class=content id=content><h1 id=基于电势的解析布局>基于电势的解析布局</h1><h2 id=基本概念>基本概念</h2><h3 id=布局的定义>布局的定义</h3><p>布局问题可以描述为一个超图问题，可以定义为如下：
$$G = (V,E,R)$$
其中$V$表示元器件（顶点）集合，$E$表示网表（超边）集合，$R$表示布局区域。在$V$中$V_m$表示可移动器件的集合，$V_f$表示固定块集合。令$n=|V_m|$表示可移动布局对象的个数。
一个合法的布局解决方案应该要满足下面三个要求：</p><ul><li>在布局区域中使用足够的空闲位置容纳每个器件</li><li>每个元器件在水平方向上要和布局行的边界对齐</li><li>元器件和宏组件不能有重合</li></ul><p>基于上述的合法性限制，布局的目标就是最小化网表的总$HPWL$，假定$\mathbf{v}=(\mathbf{x},\mathbf{y})$表示一个布局的方案，其中$\mathbf{x}={x_i|i \in V_m}$表示所有元器件的水平坐标，$\mathbf{y}={y_i|i \in V_m}$表示元器件的垂直坐标，则对于每个网表$e(e \in E)$，其半周线长的定义如下：</p><p>$$HPWL_e(\mathbf{v}) = \max_{i,j \in e}|x_i-x_j|+\max_{i,j \in e}|y_i-y_j| \tag 1$$
则总半周线长定义为：
$$HPWL(\mathbf{v}) = \sum_{e \in E} HPWL_e(\mathbf{v})$$
布局问题定义为如下：
$$\min_\mathbf{v}HPWL(\mathbf{v})，使得\mathbf{v}是一个合法的布局方案 \tag 2$$</p><h3 id=全局布局的定义>全局布局的定义</h3><p>把布局区域$R$按$m*m$划分成一个一个的格子（称作bin），这些格子的集合是B，其中$\rho_b(\mathbf{v})$表示每个b的密度，其定义如下：
$$\rho_b(\mathbf{v}) = \sum_{i \in V} l_x(b,i)l_y(b,i) \tag 3$$
其中$l_x(b,i)$和$l_y(b,i)$分别表示元器件i和格子b之间的水平和垂直重合，全局布局的定义如下：
$$\min_\mathbf{v}HPWL(\mathbf{v})\ s.t.\rho_b(\mathbf{v})\leq \rho_t, \forall b \in B \tag 4$$</p><h4 id=线长平滑化>线长平滑化</h4><p>每一个网表$e={(x_1,y_1),(x_2,y_2),\cdots,(x_n,y_n)}$有n个引脚 ,对数和指数（LSE）在水平轴x方向的线长平滑公式如下：</p><p>$$W_e(\mathbf{v}) =\gamma
\begin{pmatrix}
ln\sum_{i \in e} exp(\frac{x_i}{\gamma})+ln\sum_{i \in e} exp(\frac{-x_i}{\gamma})
\end{pmatrix}
\tag{5}$$</p><p>其中${\gamma}$是平滑参数，不能随意设置的足够小。</p><p>权重平均（WA）在水平轴x方向的线长平滑公式如下：</p><p>$$W_e(\mathbf{v}) =
\begin{pmatrix}
\frac{\sum_{i \in e} x_iexp(\frac{x_i}{\gamma})}{\sum_{i \in e} exp(\frac{x_i}{\gamma})}-\frac{\sum_{i \in e} x_iexp(-\frac{x_i}{\gamma})}{\sum_{i \in e} exp(-\frac{x_i}{\gamma})}
\end{pmatrix}
\tag{6}$$</p><h3 id=密度惩罚>密度惩罚</h3><p>在实际的布局当中，$|B|$个格子的密度都需要满足限制，我们把这些限制用一个惩罚项$N(\mathbf{v})$来表示，当惩罚项$N(\mathbf{v})=0$时所有的密度都满足，其定义如下：
$$\rho_b(\mathbf{v})\leq \rho_t, \forall b \in B \iff N(\mathbf{v})=0 \tag 7$$
用二次惩罚项来表示如下：
$$N(\mathbf{v})=\sum_{b \in B }(\widetilde \rho_{b}(\mathbf{v})- \rho_t)^2 \tag 8$$
其中$\widetilde \rho_{b}$表示在Naylor et al. 2001中定义的铃状的平滑密度函数，密度惩罚$N(\mathbf{v})$也用来表示系统的势能。</p><h3 id=非线性布局优化方程>非线性布局优化方程</h3><p>利用惩罚因子$\lambda$目标函数$f(\mathbf{v})$的定义：
$$\min_\mathbf{v} f(\mathbf{v}) = W(\mathbf{v})+\lambda N(\mathbf{v}) \tag 9$$
也可以用拉格郎日乘子法写成下面的形式：
$$\min_\mathbf{v} f(\mathbf{v}) = W(\mathbf{v})+\sum_{b \in B}\lambda_b|\widetilde \rho_{b}(\mathbf{v})- \rho_t| \tag{10}$$
其中$\lambda_b$表示每个格子b的密度限制参数乘子</p><h2 id=静电系统建模edensity>静电系统建模（eDensity）</h2><p>电势和电场分布由系统中的所有元素决定，在网表中的每个节点（元器件或者宏块）带正电苛的粒子i。粒子的带电量$q_i$表示为节点的面积$A_i$，根据洛仁力量定律(Lorentz force law)定义的电力$F_i=q_i \xi_i$，会引起可移动的节点i的运动，$\xi_i$表示节点i的布局电场。同样的$N_i=q_i \psi_i$表示节点的势能，$\psi_i$表示器件i的电势大小。根据库仑定律，器件i的电场和电势是系统中剩余器件共同作用的叠加。
整个布局的电苛密度分布表示为$\rho(x,y)$，$\xi_x(x,y)$表示水平电场的分布函数，表示$\psi(x,y)$电势分布函数。
<img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327164926.png data-srcset="https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327164926.png, https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327164926.png 1.5x, https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327164926.png 2x" data-sizes=auto alt=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327164926.png title=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327164926.png></p><h3 id=静电平衡系统建模>静电平衡系统建模</h3><p>布局系统和静电系统的建模图：</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327165122.png data-srcset="https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327165122.png, https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327165122.png 1.5x, https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327165122.png 2x" data-sizes=auto alt=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327165122.png title=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327165122.png></p><p>根据建模规则，把均匀分布的全局布局约束同静电平衡的系统状态联系起来，电力为帮助指引电苛（元器件）的向着平衡状态的方向移动。根据高斯法则，电场等于电势的负梯度，如下定义：
$$\xi(x,y)=(\xi_x,\xi_y)=-\nabla\psi(x,y)=
\begin{pmatrix}
-\frac{∂\psi(x,y)}{∂x},-\frac{∂\psi(x,y)}{∂y}
\end{pmatrix} \tag{11}$$
电苛的密度函数等于电场函数的散度
$$\rho(x,y)=\nabla \cdot \xi(x,y)=-\nabla \cdot \nabla\psi(x,y)=-
\begin{pmatrix}
\frac{∂^2\psi(x,y)}{∂x^2}+\frac{∂^2\psi(x,y)}{∂y^2}
\end{pmatrix} \tag{12}$$
静电系统如果只有正电苛那么只会产生排斥力，相应的静电平衡状态会把所有的器件沿着边界进行分布，因为在边界上可以违反布局约束。因此需要从密度分布当中移除直流组件（即0频率组件）去产生负电苛，从而整个布局区域的密度函数整体变为0。
具体一点说，因为密度函数把所有的对象转化成了正电苛，因此就产生了一个正电苛密度分布。然后就是当直流电移除后，需要填充的区域的电量会比原来有直流电的时候的电量更小，因此就变成了负电苛。同时过于填充的区域依然是正电苛（但是电量比原来小了）。正电苛多的地方会向着负电苛区域移动，相互中和，从而达到一个静电平衡的状态。使得整个系统在布局区域内达到电苛密度为0并且电势也降到0。
这样就把布局的密度惩罚和梯度建模为了势能和电场。‘</p><h3 id=密度惩罚和梯度>密度惩罚和梯度</h3><p>势能的总和等于新的元器件集合$V^{&rsquo;}$中所有带电元素的势能之和，这些元素包含了来自$V$中的可移动节点、固定宏节点，也包含了下一步要讨论的填充节点和暗节点。</p><h4 id=填充节点插入>填充节点插入</h4><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191136.png data-srcset="https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191136.png, https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191136.png 1.5x, https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191136.png 2x" data-sizes=auto alt=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191136.png title=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191136.png>
<img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191149.png data-srcset="https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191149.png, https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191149.png 1.5x, https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191149.png 2x" data-sizes=auto alt=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191149.png title=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327191149.png></p><p>上图中的黑色长方形表示宏元器件，红点表示标准元器件，蓝点表示填充节点，随着填充节点充斥在空白区域，有了更小的总线长，同时器件也挤压在了一起，相互离的更近。</p><p>$A_m$表示可移动节点的总面积，$A_{ws}$表示空白空间的总面积。如果目标密度是$\rho_t \geq \frac{A_m}{A_{ws}}$，均匀密度分布会过度的把器件平铺，引起了不必要的线长增加。填充节点（filler cell）都是等尺寸（距形）的，可以移动和并且是断连（0引脚）。$A_{fc}$表示填充节点的总面积，定义如下：
$$A_{fc} = \rho_tA_{ws}-A_m \tag{13}$$
每个填充节点$i$的面积是$A_i$，这个是由可移动器件的面积分布所决定的。每个填充节点的尺寸是可移动器件的中间80%的平均尺寸。填充节点的插入会增加额外的密度力，这会使得元器件和他的连接器件之间的距离更小，同时也会满足密度约束。全局布局结束以后，所有的填充节点都会删除。</p><h3 id=暗节点插入>暗节点插入</h3><p>用一个均匀的网格$R(m*m)$铺在所有的布局区域上，$R$里面不属于任何布局区域的所有空间都会被划分成一个包含很多长方形格子的集合，每一个格子就是一个暗节点， 对于暗节点的处理方式和固定器件的处理方式一致。$V_d$表示所有的暗节点集合，$A_d$表示所有的节点的总面积。当可移动节点到达布局的边界上时，可移动节点会因为受到暗节点的排斥力而停止。</p><h3 id=密度缩放>密度缩放</h3><p>填充节点插入后，目标密度就变成了$\rho_t = \frac{A_m+A_{fc}}{A_{ws}}$。为了去维持全局等效的密度分布，每一个固定节点或者暗节点$i$的面积$A_i$都需要通过$\rho_t$进行缩放，否则密度力会变得比填充物的密度力更大，并把器件排斥开，固定结点周围的空白区域会被置空，也会增加下图所示的线长开销。
<img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327200255.png data-srcset="https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327200255.png, https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327200255.png 1.5x, https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327200255.png 2x" data-sizes=auto alt=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327200255.png title=https://cdn.staticaly.com/gh/SivanLaai/image-store-rep@master/note/20230327200255.png>
上图中(a)和(b)在没有密度缩放的情况下，在大组件上网格的密度会高于目标密度，从而密度力会把器件从大组件周围推开，从而引起了宏组件周围更多待填充的空白区域和线长开销。</p><h3 id=势能计算>势能计算</h3><p>$V^{&rsquo;}=V_m \bigcup V_f \bigcup V_{fc} \bigcup V_d$表示系统中所有元素的集合，对于每一个节点$i \in V^{&rsquo;}$，$\rho_i$、$\xi_i$和$\psi_i$分别表示该节点的电密度、电场和电势。给定一个可移动器件集合$V_m$和填充节点集合$V_{fc}$的布局方案$\mathbf{v}$，其总的势能如下表示：
$$N(\mathbf{v})=\frac{1}{2}\sum_{i \in V^{&rsquo;} }N_i=\frac{1}{2}\sum_{i \in V^{&rsquo;} }q_i\psi_i \tag{14}$$
因为系统的势能会等于所有的电苛的相互作用之和，所以每个单节点需要乘以$\frac{1}{2}$，把重多网格密度约束问题转化成了一个0势能系统的单一势能约束$N(\mathbf{v})=0$。通过引入惩罚因子$\lambda$，一个不受约束的优化问题如下：
$$\min_\mathbf{v} f = W(\mathbf{v})+\lambda N(\mathbf{v}) \tag{15}$$
其中$W(\mathbf{v})$是来自方程6，$f(\mathbf{v})$表示的是最小化的代价函数。因为$W(\mathbf{v})$和$N(\mathbf{v})$都是平滑的，我们可以通过求微分得到如下的梯度向量$\nabla f(\mathbf{v})$：
$$\nabla f(\mathbf{v}) = \nabla W(\mathbf{v})+\lambda\nabla N(\mathbf{v})=
\begin{pmatrix}
\frac{∂W}{∂x_1},\frac{∂W}{∂y_1},\cdots
\end{pmatrix}^T - \lambda(q_1{\xi_1}_x,q_1{\xi_1}_y,\cdots)^T
\tag{16}$$</p><h2 id=泊松方程>泊松方程</h2><p>用来解决优化问题内部的计算，主要用于求解FFT计算</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2023-03-27 21:44:11">更新于 2023-03-27&nbsp;<a class=git-hash href=https://github.com/SivanLaai/blog/commit/11984dbaca7b0900acf523a1a785acda5f99adc2 rel="external nofollow noopener noreferrer" target=_blank title="commit by SivanLaai(lyhhap@163.com) 11984dbaca7b0900acf523a1a785acda5f99adc2: update passages"><i class="fa-solid fa-hashtag fa-fw" aria-hidden=true></i>11984db</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/research/eplace/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span><span><a href=https://github.com/SivanLaai/blog/edit/master/content/posts/research/eplace.md title=编辑此页 target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>编辑此页</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://www.laais.cn/posts/research/eplace/ data-title=基于电势的解析布局 data-hashtags=论文阅读><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://www.laais.cn/posts/research/eplace/ data-hashtag=论文阅读><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://www.laais.cn/posts/research/eplace/ data-title=基于电势的解析布局><i class="fa-brands fa-hacker-news fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://www.laais.cn/posts/research/eplace/ data-title=基于电势的解析布局><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://www.laais.cn/posts/research/eplace/ data-title=基于电势的解析布局><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/ class=post-tag>论文阅读</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/research/read_paper/ class=post-nav-item rel=prev title=论文阅读总结><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>论文阅读总结</a></div></div><div id=comments><div id=waline class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://waline.js.org/ rel="external nofollow noopener noreferrer">Waline</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2018 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=https://www.laais.cn target=_blank rel="external nofollow noopener noreferrer">SivanLaai</a></span></div><div class="footer-line statistics"><span class=site-time title='网站运行中 ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i>&nbsp;<span class=run-times>网站运行中 ...</span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/SivanLaai/blog title="在 GitHub 上查看源代码" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#000;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/waline/waline.css><link rel=stylesheet href=/lib/katex/katex.min.css><script src=/lib/waline/waline.js defer></script><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/lazysizes/lazysizes.min.js async defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{enable:!0,expired:!1,waline:{copyright:!0,dark:"body[data-theme='dark']",el:"#waline",emoji:["//unpkg.com/@waline/emojis@1.1.0/weibo"],highlighter:!1,imageUploader:!1,lang:"zh-cn",login:"enable",meta:["nick","mail","link"],pageSize:10,pageview:!0,search:!1,serverURL:"https://comment.sivanlaai.top/",texRenderer:!1}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},siteTime:"2018-12-18T16:15:22+08:00",watermark:{content:'\u003cimg class="fixit-icon" src="/safari-pinned-tab.svg" alt="FixIt logo" /\u003e FixIt 主题',enable:!0,height:21,opacity:.0125}}</script><script src=/js/theme.min.js defer></script></body></html>