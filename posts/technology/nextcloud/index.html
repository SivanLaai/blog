<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>nextcloud配置 - SivanLaai's Blog</title><meta name=author content="SivanLaai"><meta name=author-link content="https://www.laais.cn"><meta name=description content="nextcloud网盘相关问题 网盘配置 （1）配置环境 Linux + Apache2 + Mysql + Php(LAMP) Example installation on Ubuntu 20.04 LTS — Nextcloud latest Administration Manual latest documentation 配置Linux + Nginx + Mysql + Php(LNMP)环境 1"><meta name=keywords content="nextcloud,apache,aria2"><meta itemprop=name content="nextcloud配置"><meta itemprop=description content="nextcloud网盘相关问题 网盘配置 （1）配置环境 Linux + Apache2 + Mysql + Php(LAMP) Example installation on Ubuntu 20.04 LTS — Nextcloud latest Administration Manual latest documentation 配置Linux + Nginx + Mysql + Php(LNMP)环境 1"><meta itemprop=datePublished content="2022-07-28T11:46:36+00:00"><meta itemprop=dateModified content="2023-03-25T15:00:10+08:00"><meta itemprop=wordCount content="2777"><meta itemprop=image content="https://www.laais.cn/avatar.png"><meta itemprop=keywords content="nextcloud,apache,aria2,"><meta property="og:title" content="nextcloud配置"><meta property="og:description" content="nextcloud网盘相关问题 网盘配置 （1）配置环境 Linux + Apache2 + Mysql + Php(LAMP) Example installation on Ubuntu 20.04 LTS — Nextcloud latest Administration Manual latest documentation 配置Linux + Nginx + Mysql + Php(LNMP)环境 1"><meta property="og:type" content="article"><meta property="og:url" content="https://www.laais.cn/posts/technology/nextcloud/"><meta property="og:image" content="https://www.laais.cn/avatar.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-28T11:46:36+00:00"><meta property="article:modified_time" content="2023-03-25T15:00:10+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.laais.cn/avatar.png"><meta name=twitter:title content="nextcloud配置"><meta name=twitter:description content="nextcloud网盘相关问题 网盘配置 （1）配置环境 Linux + Apache2 + Mysql + Php(LAMP) Example installation on Ubuntu 20.04 LTS — Nextcloud latest Administration Manual latest documentation 配置Linux + Nginx + Mysql + Php(LNMP)环境 1"><meta name=application-name content="Sivanlaai's blog"><meta name=apple-mobile-web-app-title content="Sivanlaai's blog"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://www.laais.cn/posts/technology/nextcloud/><link rel=prev href=https://www.laais.cn/posts/technology/wordpress/><link rel=next href=https://www.laais.cn/posts/technology/auto_deploy_with_obsidian/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"nextcloud配置","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.laais.cn\/posts\/technology\/nextcloud\/"},"image":["https:\/\/www.laais.cn\/apple-touch-icon.png"],"genre":"posts","keywords":"nextcloud, apache, aria2","wordcount":2777,"url":"https:\/\/www.laais.cn\/posts\/technology\/nextcloud\/","datePublished":"2022-07-28T11:46:36+00:00","dateModified":"2023-03-25T15:00:10+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"SivanLaai","logo":"https:\/\/www.laais.cn\/avatar.png"},"author":{"@type":"Person","name":"SivanLaai"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title="SivanLaai's Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/avatar.png data-srcset="/avatar.png, /avatar.png 1.5x, /avatar.png 2x" data-sizes=auto alt="SivanLaai's Blog" title="SivanLaai's Blog"><span class=header-title-text>SivanLaai's blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item>没有更多翻译</li></ul></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="SivanLaai's Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/avatar.png data-srcset="/avatar.png, /avatar.png 1.5x, /avatar.png 2x" data-sizes=auto alt=/avatar.png title=/avatar.png><span class=header-title-text>SivanLaai's blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item text-center"><a class=menu-link href=https://github.com/SivanLaai/blog title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw' aria-hidden=true></i></a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option disabled>没有更多翻译</option></select></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?aa4e404535364259553aa4bd8f89bb3a",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><main class=container data-page-style=custom><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>nextcloud配置</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://www.laais.cn title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class="lazyload avatar" src=/svg/loading.min.svg data-src="https://gravatar.loli.net/avatar/8fb4e47a8c0333cba9e66f2aa7592f10?s=32&amp;d=mp" data-srcset="https://gravatar.loli.net/avatar/8fb4e47a8c0333cba9e66f2aa7592f10?s=32&amp;d=mp, https://gravatar.loli.net/avatar/8fb4e47a8c0333cba9e66f2aa7592f10?s=32&amp;d=mp 1.5x, https://gravatar.loli.net/avatar/8fb4e47a8c0333cba9e66f2aa7592f10?s=32&amp;d=mp 2x" data-sizes=auto alt=SivanLaai title=SivanLaai>&nbsp;SivanLaai</a></span>
<span class=post-category>收录于 <a href=/categories/%E6%95%99%E7%A8%8B/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 教程</a></span></div><div class=post-meta-line><span title="2022-07-28 11:46:36"><i class="fa-regular fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-07-28>2022-07-28</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw" aria-hidden=true></i> 约 2777 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw" aria-hidden=true></i> 预计阅读 6 分钟</span>&nbsp;<span class=comment-visitors data-flag-title=nextcloud配置>
<i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span data-path=/posts/technology/nextcloud/ class=waline-pageview-count>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#nextcloud网盘相关问题>nextcloud网盘相关问题</a><ul><li><a href=#网盘配置>网盘配置</a><ul><li><a href=#1配置环境>（1）配置环境</a></li><li><a href=#2安装nextcloud>（2）安装nextcloud</a></li><li><a href=#3nginx配置解析php>（3）Nginx配置解析php</a></li></ul></li><li><a href=#请更改权限为-0770-以避免其他用户查看目录>请更改权限为 0770 以避免其他用户查看目录</a></li><li><a href=#安装配置启动aria2>安装配置启动aria2</a><ul><li><a href=#安装aria2>安装aria2</a></li><li><a href=#创建配置文件>创建配置文件</a></li><li><a href=#启动aria2>启动aria2</a></li><li><a href=#配置aria2-自动更新bt-tracker>配置aria2 自动更新bt tracker</a></li><li><a href=#配置nextcloud启动脚本>配置nextcloud启动脚本</a></li><li><a href=#配置aria2ng>配置aria2NG</a></li><li><a href=#配置apache2网页>配置apache2网页</a></li></ul></li><li><a href=#nextcloud镜像安装>Nextcloud镜像安装</a></li></ul></li></ul><ul><li><ul><li><a href=#apache2解析失败php>apache2解析失败php</a></li><li><a href=#apache2提示找不到apacheconf>apache2提示找不到<code>apache.conf</code></a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=nextcloud网盘相关问题>nextcloud网盘相关问题</h2><h3 id=网盘配置>网盘配置</h3><h4 id=1配置环境>（1）配置环境</h4><ul><li>Linux + Apache2 + Mysql + Php(LAMP)
<a href=https://docs.nextcloud.com/server/latest/admin_manual/installation/example_ubuntu.html target=_blank rel="external nofollow noopener noreferrer">Example installation on Ubuntu 20.04 LTS — Nextcloud latest Administration Manual latest documentation<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li><li>配置Linux + Nginx + Mysql + Php(LNMP)环境</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update <span class=o>&amp;&amp;</span> sudo apt upgrade
</span></span><span class=line><span class=cl>sudo apt install mariadb-server nginx php-gd php-mysql php-fpm <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>php-curl php-mbstring php-intl php-gmp php-bcmath php-xml php-imagick php-zip
</span></span></code></pre></td></tr></table></div></div><h4 id=2安装nextcloud>（2）安装nextcloud</h4><p><a href=https://docs.nextcloud.com/server/latest/admin_manual/installation/source_installation.html target=_blank rel="external nofollow noopener noreferrer">Installation on Linux — Nextcloud latest Administration Manual latest documentation<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p><h4 id=3nginx配置解析php>（3）Nginx配置解析php</h4><ul><li>Nginx配置上传大小</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># /etc/nginx/nginx.conf</span>
</span></span><span class=line><span class=cl>http <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	client_max_body_size 20480M<span class=p>;</span>
</span></span><span class=line><span class=cl>	client_body_buffer_size 10M<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>修改配置</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># /etc/nginx/conf.d/nextcloud.conf</span>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl><span class=c1># You should look at the following URL&#39;s in order to grasp a solid understanding</span>
</span></span><span class=line><span class=cl><span class=c1># of Nginx configuration files in order to fully unleash the power of Nginx.</span>
</span></span><span class=line><span class=cl><span class=c1># https://www.nginx.com/resources/wiki/start/</span>
</span></span><span class=line><span class=cl><span class=c1># https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/</span>
</span></span><span class=line><span class=cl><span class=c1># https://wiki.debian.org/Nginx/DirectoryStructure</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># In most cases, administrators will remove this file from sites-enabled/ and</span>
</span></span><span class=line><span class=cl><span class=c1># leave it as reference inside of sites-available where it will continue to be</span>
</span></span><span class=line><span class=cl><span class=c1># updated by the nginx packaging team.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># This file will automatically load configuration files provided by other</span>
</span></span><span class=line><span class=cl><span class=c1># applications, such as Drupal or Wordpress. These applications will be made</span>
</span></span><span class=line><span class=cl><span class=c1># available underneath a path with that package name, such as /drupal8.</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.</span>
</span></span><span class=line><span class=cl><span class=c1>##</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Default server configuration</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl>upstream php-handler <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=c1>#server 127.0.0.1:9000;</span>
</span></span><span class=line><span class=cl>	server unix:/run/php/php8.1-fpm.sock<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>server <span class=o>{</span>
</span></span><span class=line><span class=cl>    listen 80<span class=p>;</span>
</span></span><span class=line><span class=cl>    listen <span class=o>[</span>::<span class=o>]</span>:80<span class=p>;</span>
</span></span><span class=line><span class=cl>    server_name nextcloud.laais.cn<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Path to the root of your installation</span>
</span></span><span class=line><span class=cl>    root /var/www/nextcloud<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Enable gzip but do not remove ETag headers</span>
</span></span><span class=line><span class=cl>    gzip on<span class=p>;</span>
</span></span><span class=line><span class=cl>    gzip_vary on<span class=p>;</span>
</span></span><span class=line><span class=cl>    gzip_comp_level 4<span class=p>;</span>
</span></span><span class=line><span class=cl>    gzip_min_length 256<span class=p>;</span>
</span></span><span class=line><span class=cl>    gzip_proxied expired no-cache no-store private no_last_modified no_etag auth<span class=p>;</span>
</span></span><span class=line><span class=cl>    gzip_types application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml application/vnd.geo+json application/vnd.ms-fontobject application/wasm application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/vtt text/x-component text/x-cross-domain-policy<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Pagespeed is not supported by Nextcloud, so if your server is built</span>
</span></span><span class=line><span class=cl>    <span class=c1># with the `ngx_pagespeed` module, uncomment this line to disable it.</span>
</span></span><span class=line><span class=cl>    <span class=c1>#pagespeed off;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># HTTP response headers borrowed from Nextcloud `.htaccess`</span>
</span></span><span class=line><span class=cl>    add_header Referrer-Policy                      <span class=s2>&#34;no-referrer&#34;</span>   always<span class=p>;</span>
</span></span><span class=line><span class=cl>    add_header X-Content-Type-Options               <span class=s2>&#34;nosniff&#34;</span>       always<span class=p>;</span>
</span></span><span class=line><span class=cl>    add_header X-Download-Options                   <span class=s2>&#34;noopen&#34;</span>        always<span class=p>;</span>
</span></span><span class=line><span class=cl>    add_header X-Frame-Options                      <span class=s2>&#34;SAMEORIGIN&#34;</span>    always<span class=p>;</span>
</span></span><span class=line><span class=cl>    add_header X-Permitted-Cross-Domain-Policies    <span class=s2>&#34;none&#34;</span>          always<span class=p>;</span>
</span></span><span class=line><span class=cl>    add_header X-Robots-Tag                         <span class=s2>&#34;none&#34;</span>          always<span class=p>;</span>
</span></span><span class=line><span class=cl>    add_header X-XSS-Protection                     <span class=s2>&#34;1; mode=block&#34;</span> always<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Remove X-Powered-By, which is an information leak</span>
</span></span><span class=line><span class=cl>    fastcgi_hide_header X-Powered-By<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Specify how to handle directories -- specifying `/index.php$request_uri`</span>
</span></span><span class=line><span class=cl>    <span class=c1># here as the fallback means that Nginx always exhibits the desired behaviour</span>
</span></span><span class=line><span class=cl>    <span class=c1># when a client requests a path that corresponds to a directory that exists</span>
</span></span><span class=line><span class=cl>    <span class=c1># on the server. In particular, if that directory contains an index.php file,</span>
</span></span><span class=line><span class=cl>    <span class=c1># that file is correctly served; if it doesn&#39;t, then the request is passed to</span>
</span></span><span class=line><span class=cl>    <span class=c1># the front-end controller. This consistent behaviour means that we don&#39;t need</span>
</span></span><span class=line><span class=cl>    <span class=c1># to specify custom rules for certain paths (e.g. images and other assets,</span>
</span></span><span class=line><span class=cl>    <span class=c1># `/updater`, `/ocm-provider`, `/ocs-provider`), and thus</span>
</span></span><span class=line><span class=cl>    <span class=c1># `try_files $uri $uri/ /index.php$request_uri`</span>
</span></span><span class=line><span class=cl>    <span class=c1># always provides the desired behaviour.</span>
</span></span><span class=line><span class=cl>    index index.php index.html /index.php<span class=nv>$request_uri</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Rule borrowed from `.htaccess` to handle Microsoft DAV clients</span>
</span></span><span class=line><span class=cl>    <span class=nv>location</span> <span class=o>=</span> / <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=o>(</span> <span class=nv>$http_user_agent</span> ~ ^DavClnt <span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=m>302</span> /remote.php/webdav/<span class=nv>$is_args$args</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>location</span> <span class=o>=</span> /robots.txt <span class=o>{</span>
</span></span><span class=line><span class=cl>        allow all<span class=p>;</span>
</span></span><span class=line><span class=cl>        log_not_found off<span class=p>;</span>
</span></span><span class=line><span class=cl>        access_log off<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Ensure this block, which passes PHP files to the PHP process, is above the blocks</span>
</span></span><span class=line><span class=cl>    <span class=c1># which handle static assets (as seen below). If this block is not declared first,</span>
</span></span><span class=line><span class=cl>    <span class=c1># then Nginx will encounter an infinite rewriting loop when it prepends `/index.php`</span>
</span></span><span class=line><span class=cl>    <span class=c1># to the URI, resulting in a HTTP 500 error response.</span>
</span></span><span class=line><span class=cl>    location ~ <span class=se>\.</span>php<span class=o>(</span>?:$<span class=p>|</span>/<span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># Required for legacy support</span>
</span></span><span class=line><span class=cl>        rewrite ^/<span class=o>(</span>?!index<span class=p>|</span>remote<span class=p>|</span>public<span class=p>|</span>cron<span class=p>|</span>core<span class=se>\/</span>ajax<span class=se>\/</span>update<span class=p>|</span>status<span class=p>|</span>ocs<span class=se>\/</span>v<span class=o>[</span>12<span class=o>]</span><span class=p>|</span>updater<span class=se>\/</span>.+<span class=p>|</span>oc<span class=o>[</span>ms<span class=o>]</span>-provider<span class=se>\/</span>.+<span class=p>|</span>.+<span class=se>\/</span>richdocumentscode<span class=se>\/</span>proxy<span class=o>)</span> /index.php<span class=nv>$request_uri</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        fastcgi_split_path_info ^<span class=o>(</span>.+?<span class=se>\.</span>php<span class=o>)(</span>/.*<span class=o>)</span>$<span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nb>set</span> <span class=nv>$path_info</span> <span class=nv>$fastcgi_path_info</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        try_files <span class=nv>$fastcgi_script_name</span> <span class=o>=</span>404<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        include fastcgi_params<span class=p>;</span>
</span></span><span class=line><span class=cl>        fastcgi_param SCRIPT_FILENAME <span class=nv>$document_root$fastcgi_script_name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        fastcgi_param PATH_INFO <span class=nv>$path_info</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        fastcgi_param modHeadersAvailable true<span class=p>;</span>         <span class=c1># Avoid sending the security headers twice</span>
</span></span><span class=line><span class=cl>        fastcgi_param front_controller_active true<span class=p>;</span>     <span class=c1># Enable pretty urls</span>
</span></span><span class=line><span class=cl>        fastcgi_pass php-handler<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        fastcgi_intercept_errors on<span class=p>;</span>
</span></span><span class=line><span class=cl>        fastcgi_request_buffering off<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        fastcgi_max_temp_file_size 0<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Rule borrowed from `.htaccess`</span>
</span></span><span class=line><span class=cl>    location /remote <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=m>301</span> /remote.php<span class=nv>$request_uri</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    location / <span class=o>{</span>
</span></span><span class=line><span class=cl>        try_files <span class=nv>$uri</span> <span class=nv>$uri</span>/ /index.php<span class=nv>$request_uri</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>set</span> <span class=nv>$jellyfin</span> 127.0.0.1<span class=p>;</span>
</span></span><span class=line><span class=cl>    location /video <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># Proxy main Jellyfin traffic</span>
</span></span><span class=line><span class=cl>	rewrite ^/video/<span class=o>(</span>.*<span class=o>)</span>$ /<span class=nv>$1</span> break<span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_pass http://<span class=nv>$jellyfin</span>:8096<span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header Host <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-For <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Proto <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Protocol <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Host <span class=nv>$http_host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># Disable buffering when the nginx proxy gets very resource heavy upon streaming</span>
</span></span><span class=line><span class=cl>        proxy_buffering off<span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># location block for /web - This is purely for aesthetics so /web/#!/ works instead of having to go to /web/index.html/#!/</span>
</span></span><span class=line><span class=cl>    <span class=nv>location</span> <span class=o>=</span> /video/web/ <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># Proxy main Jellyfin traffic</span>
</span></span><span class=line><span class=cl>        proxy_pass http://<span class=nv>$jellyfin</span>:8096/web/index.html<span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header Host <span class=nv>$host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Real-IP <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-For <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Proto <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Protocol <span class=nv>$scheme</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        proxy_set_header X-Forwarded-Host <span class=nv>$http_host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>生效服务</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo service nginx restart
</span></span><span class=line><span class=cl>sudo service php8.1-fpm restart
</span></span></code></pre></td></tr></table></div></div><h3 id=请更改权限为-0770-以避免其他用户查看目录>请更改权限为 0770 以避免其他用户查看目录</h3><p>config.php</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.
</span></span><span class=line><span class=cl><span class=s1>&#39;check_data_directory_permissions&#39;</span> <span class=o>=</span>&gt; false,
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><h3 id=安装配置启动aria2>安装配置启动aria2</h3><ul><li><h4 id=安装aria2>安装aria2</h4></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install aria2
</span></span><span class=line><span class=cl><span class=nb>cd</span> /etc/ <span class=o>&amp;&amp;</span> mkdir aria2 <span class=o>&amp;&amp;</span> <span class=nb>cd</span> aria2 <span class=o>&amp;&amp;</span> touch aria2c.conf <span class=o>&amp;&amp;</span> touch aria2.session
</span></span></code></pre></td></tr></table></div></div><ul><li><h4 id=创建配置文件>创建配置文件</h4></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>#aria2c.conf</span>
</span></span><span class=line><span class=cl><span class=c1>## 文件保存相关 ##</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 文件保存目录</span>
</span></span><span class=line><span class=cl><span class=nv>dir</span><span class=o>=</span>/var/www/nextcloud/data/nextcloud/files/Video
</span></span><span class=line><span class=cl><span class=c1># 启用磁盘缓存, 0为禁用缓存, 需1.16以上版本, 默认:16M</span>
</span></span><span class=line><span class=cl>disk-cache<span class=o>=</span>32M
</span></span><span class=line><span class=cl><span class=c1># 断点续传</span>
</span></span><span class=line><span class=cl><span class=k>continue</span><span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 文件预分配方式, 能有效降低磁盘碎片, 默认:prealloc</span>
</span></span><span class=line><span class=cl><span class=c1># 预分配所需时间: none &lt; falloc ? trunc &lt; prealloc</span>
</span></span><span class=line><span class=cl><span class=c1># falloc和trunc则需要文件系统和内核支持</span>
</span></span><span class=line><span class=cl><span class=c1># NTFS建议使用falloc, EXT3/4建议trunc, MAC 下需要注释此项</span>
</span></span><span class=line><span class=cl>file-allocation<span class=o>=</span>trunc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 下载连接相关 ##</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 最大同时下载任务数, 运行时可修改, 默认:5</span>
</span></span><span class=line><span class=cl><span class=c1>#max-concurrent-downloads=10</span>
</span></span><span class=line><span class=cl><span class=c1># 同一服务器连接数, 添加时可指定, 默认:1</span>
</span></span><span class=line><span class=cl><span class=c1># 官方的aria2最高设置为16, 如果需要设置任意数值请重新编译aria2</span>
</span></span><span class=line><span class=cl>max-connection-per-server<span class=o>=</span><span class=m>16</span>
</span></span><span class=line><span class=cl><span class=c1># 整体下载速度限制, 运行时可修改, 默认:0（不限制）</span>
</span></span><span class=line><span class=cl><span class=c1>#max-overall-download-limit=0</span>
</span></span><span class=line><span class=cl><span class=c1># 单个任务下载速度限制, 默认:0（不限制）</span>
</span></span><span class=line><span class=cl><span class=c1>#max-download-limit=0</span>
</span></span><span class=line><span class=cl><span class=c1># 整体上传速度限制, 运行时可修改, 默认:0（不限制）</span>
</span></span><span class=line><span class=cl><span class=c1>#max-overall-upload-limit=0</span>
</span></span><span class=line><span class=cl><span class=c1># 单个任务上传速度限制, 默认:0（不限制）</span>
</span></span><span class=line><span class=cl><span class=c1>#max-upload-limit=0</span>
</span></span><span class=line><span class=cl><span class=c1># 禁用IPv6, 默认:false</span>
</span></span><span class=line><span class=cl><span class=c1># disable-ipv6=true</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 最小文件分片大小, 添加时可指定, 取值范围1M -1024M, 默认:20M</span>
</span></span><span class=line><span class=cl><span class=c1># 假定size=10M, 文件为20MiB 则使用两个来源下载; 文件为15MiB 则使用一个来源下载</span>
</span></span><span class=line><span class=cl>min-split-size<span class=o>=</span>10M
</span></span><span class=line><span class=cl><span class=c1># 单个任务最大线程数, 添加时可指定, 默认:5</span>
</span></span><span class=line><span class=cl><span class=c1># 建议同max-connection-per-server设置为相同值</span>
</span></span><span class=line><span class=cl><span class=nv>split</span><span class=o>=</span><span class=m>16</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 进度保存相关 ##</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 从会话文件中读取下载任务</span>
</span></span><span class=line><span class=cl>input-file<span class=o>=</span>/etc/aria2/aria2.session
</span></span><span class=line><span class=cl><span class=c1># 在Aria2退出时保存错误的、未完成的下载任务到会话文件</span>
</span></span><span class=line><span class=cl>save-session<span class=o>=</span>/etc/aria2/aria2.session
</span></span><span class=line><span class=cl><span class=c1># 定时保存会话, 0为退出时才保存, 需1.16.1以上版本, 默认:0</span>
</span></span><span class=line><span class=cl>save-session-interval<span class=o>=</span><span class=m>60</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## RPC相关设置 ##</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 启用RPC, 默认:false</span>
</span></span><span class=line><span class=cl>enable-rpc<span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=c1># 允许所有来源, 默认:false</span>
</span></span><span class=line><span class=cl>rpc-allow-origin-all<span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=c1># 允许外部访问, 默认:false</span>
</span></span><span class=line><span class=cl>rpc-listen-all<span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=c1># RPC端口, 仅当默认端口被占用时修改</span>
</span></span><span class=line><span class=cl><span class=c1># rpc-listen-port=6800</span>
</span></span><span class=line><span class=cl><span class=c1># 设置的RPC授权令牌, v1.18.4新增功能, 取代 --rpc-user 和 --rpc-passwd 选项</span>
</span></span><span class=line><span class=cl>rpc-secret<span class=o>=</span>passwd <span class=c1>#在访问的时候要使用到的密码</span>
</span></span><span class=line><span class=cl><span class=c1># 启动SSL</span>
</span></span><span class=line><span class=cl><span class=c1>#rpc-secure=true</span>
</span></span><span class=line><span class=cl><span class=c1># 证书文件, 如果启用SSL则需要配置证书文件, 例如用https连接aria2</span>
</span></span><span class=line><span class=cl><span class=c1>#rpc-certificate=/var/snap/nextcloud/current/certs/live/fullchain.pem</span>
</span></span><span class=line><span class=cl><span class=c1>#rpc-private-key=/var/snap/nextcloud/current/certs/live/privkey.pem</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## BT/PT下载相关 ##</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 当下载的是一个种子(以.torrent结尾)时, 自动开始BT任务, 默认:true</span>
</span></span><span class=line><span class=cl>follow-torrent<span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=c1># 客户端伪装, PT需要</span>
</span></span><span class=line><span class=cl>peer-id-prefix<span class=o>=</span>-TR2770-
</span></span><span class=line><span class=cl>user-agent<span class=o>=</span>Transmission/2.77
</span></span><span class=line><span class=cl><span class=c1># 强制保存会话, 即使任务已经完成, 默认:false</span>
</span></span><span class=line><span class=cl><span class=c1># 较新的版本开启后会在任务完成后依然保留.aria2文件</span>
</span></span><span class=line><span class=cl><span class=c1>#force-save=false</span>
</span></span><span class=line><span class=cl><span class=c1># 继续之前的BT任务时, 无需再次校验, 默认:false</span>
</span></span><span class=line><span class=cl>bt-seed-unverified<span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=c1># 保存磁力链接元数据为种子文件(.torrent文件), 默认:false</span>
</span></span><span class=line><span class=cl><span class=c1># bt-save-metadata=true</span>
</span></span><span class=line><span class=cl><span class=c1># 单个种子最大连接数, 默认:55 0表示不限制</span>
</span></span><span class=line><span class=cl>bt-max-peers<span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl><span class=c1># 最小做种时间, 单位:分</span>
</span></span><span class=line><span class=cl>seed-time <span class=o>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=c1># 分离做种任务</span>
</span></span><span class=line><span class=cl>bt-detach-seed-only<span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl>on-download-complete<span class=o>=</span>/home/filesscan.sh
</span></span></code></pre></td></tr></table></div></div><ul><li><h4 id=启动aria2>启动aria2</h4></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nohup aria2c --conf-path<span class=o>=</span>/etc/aria2/aria2.conf &gt; /home/linux/aria2.log 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><h4 id=配置aria2-自动更新bt-tracker>配置aria2 自动更新bt tracker</h4></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># startaria.sh</span>
</span></span><span class=line><span class=cl><span class=k>while</span><span class=o>(</span><span class=nb>true</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl>sudo <span class=nb>kill</span> -9 <span class=k>$(</span>ps -ef<span class=p>|</span>grep aria2<span class=p>|</span>gawk <span class=s1>&#39;$0 !~/grep/ {print $2}&#39;</span> <span class=p>|</span>tr -s <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39; &#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>list</span><span class=o>=</span><span class=sb>`</span>wget -qO- https://raw.githubusercontent.com/ngosang/trackerslist/master/trackers_best.txt<span class=p>|</span>awk NF<span class=p>|</span>sed <span class=s2>&#34;:a;N;s/\n/,/g;ta&#34;</span><span class=sb>`</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$list</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> -z <span class=s2>&#34;`grep &#34;</span>bt-tracker<span class=s2>&#34; /etc/aria2/aria2.conf`&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>   sudo sed -i <span class=s1>&#39;$a bt-tracker=&#39;</span><span class=si>${</span><span class=nv>list</span><span class=si>}</span>  /etc/aria2/aria2.conf
</span></span><span class=line><span class=cl>   <span class=nb>echo</span> add......
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    sudo sed -i <span class=s2>&#34;s@bt-tracker.*@bt-tracker=</span><span class=nv>$list</span><span class=s2>@g&#34;</span> /etc/aria2/aria2.conf
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> update......
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>sudo aria2c --conf-path<span class=o>=</span>/etc/aria2/aria2.conf
</span></span><span class=line><span class=cl>sleep 24h
</span></span><span class=line><span class=cl><span class=c1>#sleep 10</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><h4 id=配置nextcloud启动脚本>配置nextcloud启动脚本</h4></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># startserver.sh</span>
</span></span><span class=line><span class=cl>sudo service apache2 stop
</span></span><span class=line><span class=cl>sudo service apache2 start
</span></span><span class=line><span class=cl>sudo /etc/init.d/mysql start
</span></span><span class=line><span class=cl><span class=c1># 运行aria2脚本更新bt trackers</span>
</span></span><span class=line><span class=cl>sudo nohup bash startaria.sh &gt; /home/linux/log/aria2.log 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl><span class=c1># 监控文件变化</span>
</span></span><span class=line><span class=cl><span class=k>while</span><span class=o>(</span><span class=nb>true</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=k>do</span>
</span></span><span class=line><span class=cl>        sudo -u www-data php /var/www/nextcloud/occ files:scan --all
</span></span><span class=line><span class=cl>        sleep <span class=m>60</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># runserver.sh</span>
</span></span><span class=line><span class=cl><span class=c1># 删除aria相关的程序</span>
</span></span><span class=line><span class=cl>sudo <span class=nb>kill</span> -9 <span class=k>$(</span>ps -ef<span class=p>|</span>grep startserver<span class=p>|</span>gawk <span class=s1>&#39;$0 !~/grep/ {print $2}&#39;</span> <span class=p>|</span>tr -s <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39; &#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>sudo <span class=nb>kill</span> -9 <span class=k>$(</span>ps -ef<span class=p>|</span>grep startaria<span class=p>|</span>gawk <span class=s1>&#39;$0 !~/grep/ {print $2}&#39;</span> <span class=p>|</span>tr -s <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39; &#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>sudo <span class=nb>kill</span> -9 <span class=k>$(</span>ps -ef<span class=p>|</span>grep aria2<span class=p>|</span>gawk <span class=s1>&#39;$0 !~/grep/ {print $2}&#39;</span> <span class=p>|</span>tr -s <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39; &#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>sudo nohup bash startserver.sh &gt; /home/linux/log/nextcloud.log 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>&amp;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><h4 id=配置aria2ng>配置aria2NG</h4></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 下载aria2ng</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> /var/www/
</span></span><span class=line><span class=cl>wget https://github.com/mayswind/AriaNg/releases/download/1.2.3/AriaNg-1.2.3.zip
</span></span><span class=line><span class=cl>mkdir ariang
</span></span><span class=line><span class=cl>unzip AriaNg-1.2.3.zip
</span></span></code></pre></td></tr></table></div></div><ul><li><h4 id=配置apache2网页>配置apache2网页</h4></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 创建/etc/apache2/sites-available/ariang.conf</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>Alias /ariang &#34;/var/www/ariang/&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>Directory</span> <span class=err>/</span><span class=na>var</span><span class=err>/</span><span class=na>www</span><span class=err>/</span><span class=na>ariang</span><span class=err>/&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>  Require all granted
</span></span><span class=line><span class=cl>  AllowOverride All
</span></span><span class=line><span class=cl>  Options FollowSymLinks MultiViews
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>IfModule</span> <span class=na>mod_dav</span><span class=err>.</span><span class=na>c</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    Dav off
</span></span><span class=line><span class=cl>  <span class=p>&lt;/</span><span class=nt>IfModule</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>Directory</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 访问http://host.example.com/ariang</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading.min.svg data-src=https://cdn.jsdelivr.net/gh/SivanLaai/image-store-rep@master/note/image-20211213104533533.png data-srcset="https://cdn.jsdelivr.net/gh/SivanLaai/image-store-rep@master/note/image-20211213104533533.png, https://cdn.jsdelivr.net/gh/SivanLaai/image-store-rep@master/note/image-20211213104533533.png 1.5x, https://cdn.jsdelivr.net/gh/SivanLaai/image-store-rep@master/note/image-20211213104533533.png 2x" data-sizes=auto alt=image-20211213104533533 title=image-20211213104533533></p><h3 id=nextcloud镜像安装>Nextcloud镜像安装</h3><ul><li>创建文件夹<code>nextcloud</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>mkdir nextcloud
</span></span></code></pre></td></tr></table></div></div><ul><li>创建文件<code>docker-compose.yml</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;2&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>nextcloud</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>db</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>db</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>mariadb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span>--<span class=l>transaction-isolation=READ-COMMITTED --binlog-format=ROW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>db:/var/lib/mysql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>MYSQL_ROOT_PASSWORD=root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>MYSQL_PASSWORD=passwd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>MYSQL_DATABASE=nextcloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>MYSQL_USER=nextcloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>app</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nextcloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>8080</span><span class=p>:</span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>links</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>nextcloud:/var/www/html</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>MYSQL_PASSWORD=passwd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>MYSQL_DATABASE=nextcloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>MYSQL_USER=nextcloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>MYSQL_HOST=db</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><ul><li>启动镜像</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker-compose up -d
</span></span></code></pre></td></tr></table></div></div><h1 id=常见问题>常见问题</h1><ul><li><h3 id=apache2解析失败php>apache2解析失败php</h3><ul><li>重新安装php</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt-get purge php8.*
</span></span><span class=line><span class=cl>sudo apt install php
</span></span></code></pre></td></tr></table></div></div></li><li><h3 id=apache2提示找不到apacheconf>apache2提示找不到<code>apache.conf</code></h3><ul><li>重新安装apache2</li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo dpkg -P apache2
</span></span><span class=line><span class=cl>apt-get remove apache2
</span></span><span class=line><span class=cl>apt-get install apache2
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2023-03-25 15:00:10">更新于 2023-03-25&nbsp;<a class=git-hash href=https://github.com/SivanLaai/blog/commit/b130062d2199245908817fb3487cd38158076f2d rel="external nofollow noopener noreferrer" target=_blank title="commit by SivanLaai(lyhhap@163.com) b130062d2199245908817fb3487cd38158076f2d: update passages"><i class="fa-solid fa-hashtag fa-fw" aria-hidden=true></i>b130062</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/technology/nextcloud/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span><span><a href=https://github.com/SivanLaai/blog/edit/master/content/posts/technology/nextcloud.md title=编辑此页 target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>编辑此页</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://www.laais.cn/posts/technology/nextcloud/ data-title=nextcloud配置 data-hashtags=nextcloud,apache,aria2><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://www.laais.cn/posts/technology/nextcloud/ data-hashtag=nextcloud><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://www.laais.cn/posts/technology/nextcloud/ data-title=nextcloud配置><i class="fa-brands fa-hacker-news fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://www.laais.cn/posts/technology/nextcloud/ data-title=nextcloud配置><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://www.laais.cn/posts/technology/nextcloud/ data-title=nextcloud配置><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/nextcloud/ class=post-tag>nextcloud</a><a href=/tags/apache/ class=post-tag>apache</a><a href=/tags/aria2/ class=post-tag>aria2</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/technology/wordpress/ class=post-nav-item rel=prev title=wordpress安装和问题><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>wordpress安装和问题</a>
<a href=/posts/technology/auto_deploy_with_obsidian/ class=post-nav-item rel=next title=Obsidian写hugo博客，github自动部署>Obsidian写hugo博客，github自动部署<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=waline class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://waline.js.org/ rel="external nofollow noopener noreferrer">Waline</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2018 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=https://www.laais.cn target=_blank rel="external nofollow noopener noreferrer">SivanLaai</a></span></div><div class="footer-line statistics"><span class=site-time title='网站运行中 ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i>&nbsp;<span class=run-times>网站运行中 ...</span></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/SivanLaai/blog title="在 GitHub 上查看源代码" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#000;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/waline/waline.css><link rel=stylesheet href=/lib/katex/katex.min.css><script src=/lib/waline/waline.js defer></script><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/lazysizes/lazysizes.min.js async defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{enable:!0,expired:!1,waline:{copyright:!0,dark:"body[data-theme='dark']",el:"#waline",emoji:["//unpkg.com/@waline/emojis@1.1.0/weibo"],highlighter:!1,imageUploader:!1,lang:"zh-cn",login:"enable",meta:["nick","mail","link"],pageSize:10,pageview:!0,search:!1,serverURL:"https://comment.laais.cn/",texRenderer:!1}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},siteTime:"2018-12-18T16:15:22+08:00",watermark:{content:'\u003cimg class="fixit-icon" src="/safari-pinned-tab.svg" alt="FixIt logo" /\u003e FixIt 主题',enable:!0,height:21,opacity:.0125}}</script><script src=/js/theme.min.js defer></script></body></html>