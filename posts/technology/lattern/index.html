<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare - SivanLaai's Blog</title><meta name=author content="SivanLaai"><meta name=author-link content="https://www.laais.cn"><meta name=description content="2020 年的第一篇博文竟然是讲虚拟砖混结构建筑物逾越技术的，感觉有点微妙。
年终总结啊，在写了在写了，明年就发。"><meta name=keywords content="V2Ray"><meta itemprop=name content="搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare"><meta itemprop=description content="2020 年的第一篇博文竟然是讲虚拟砖混结构建筑物逾越技术的，感觉有点微妙。
年终总结啊，在写了在写了，明年就发。"><meta itemprop=datePublished content="2020-01-12T20:20:00+00:00"><meta itemprop=dateModified content="2023-04-03T08:38:32+08:00"><meta itemprop=wordCount content="2358"><meta itemprop=image content="https://www.laais.cn/avatar.png"><meta itemprop=keywords content="V2Ray,"><meta property="og:title" content="搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare"><meta property="og:description" content="2020 年的第一篇博文竟然是讲虚拟砖混结构建筑物逾越技术的，感觉有点微妙。
年终总结啊，在写了在写了，明年就发。"><meta property="og:type" content="article"><meta property="og:url" content="https://www.laais.cn/posts/technology/lattern/"><meta property="og:image" content="https://www.laais.cn/avatar.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-01-12T20:20:00+00:00"><meta property="article:modified_time" content="2023-04-03T08:38:32+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.laais.cn/avatar.png"><meta name=twitter:title content="搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare"><meta name=twitter:description content="2020 年的第一篇博文竟然是讲虚拟砖混结构建筑物逾越技术的，感觉有点微妙。
年终总结啊，在写了在写了，明年就发。"><meta name=application-name content="Sivanlaai's blog"><meta name=apple-mobile-web-app-title content="Sivanlaai's blog"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://www.laais.cn/posts/technology/lattern/><link rel=prev href=https://www.laais.cn/posts/research/multiclass_svm/><link rel=next href=https://www.laais.cn/posts/projects/rime/info/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.laais.cn\/posts\/technology\/lattern\/"},"image":["https:\/\/www.laais.cn\/apple-touch-icon.png"],"genre":"posts","keywords":"V2Ray","wordcount":2358,"url":"https:\/\/www.laais.cn\/posts\/technology\/lattern\/","datePublished":"2020-01-12T20:20:00+00:00","dateModified":"2023-04-03T08:38:32+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"SivanLaai","logo":"https:\/\/www.laais.cn\/avatar.png"},"author":{"@type":"Person","name":"prinsss"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=right><div class=header-title><a href=/ title="SivanLaai's Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/avatar.png data-srcset="/avatar.png, /avatar.png 1.5x, /avatar.png 2x" data-sizes=auto alt="SivanLaai's Blog" title="SivanLaai's Blog"><span class=header-title-text>SivanLaai's blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item>没有更多翻译</li></ul></li><li class="menu-item search" id=search-desktop><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="SivanLaai's Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/avatar.png data-srcset="/avatar.png, /avatar.png 1.5x, /avatar.png 2x" data-sizes=auto alt=/avatar.png title=/avatar.png><span class=header-title-text>SivanLaai's blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="搜索文章标题或内容 ..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/posts/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 所有文章</a></li><li class=menu-item><a class=menu-link href=/categories/><i class="fa-solid fa-th fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/about/><i class="fa-solid fa-info-circle fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item text-center"><a class=menu-link href=https://github.com/SivanLaai/blog title=GitHub rel="noopener noreferrer" target=_blank><i class='fa-brands fa-github fa-fw' aria-hidden=true></i></a></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class="menu-item language"><span role=button aria-label=选择语言 title=选择语言>简体中文<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i></span>
<select class=language-select onchange="location=this.value"><option disabled>没有更多翻译</option></select></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?aa4e404535364259553aa4bd8f89bb3a",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><main class=container data-page-style=custom><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
prinsss</span></span>
<span class=post-category>收录于 <a href=/categories/%E6%8A%80%E6%9C%AF/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 技术</a></span></div><div class=post-meta-line><span title="2020-01-12 20:20:00"><i class="fa-regular fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2020-01-12>2020-01-12</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw" aria-hidden=true></i> 约 2358 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw" aria-hidden=true></i> 预计阅读 5 分钟</span>&nbsp;<span class=comment-visitors data-flag-title="搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare">
<i class="fa-regular fa-eye fa-fw" aria-hidden=true></i>&nbsp;<span data-path=/posts/technology/lattern/ class=waline-pageview-count>-</span>&nbsp;次阅读
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#1-安装-v2ray>1. 安装 V2Ray</a></li><li><a href=#2-配置-v2ray-服务端>2. 配置 V2Ray 服务端</a></li><li><a href=#3-运行-v2ray>3. 运行 V2Ray</a></li><li><a href=#4-配置-nginx>4. 配置 Nginx</a></li><li><a href=#5-配置-cloudflare>5. 配置 CloudFlare</a></li><li><a href=#6-配置-v2ray-客户端>6. 配置 V2Ray 客户端</a></li><li><a href=#常见问题>常见问题</a><ul><li><a href=#tun模式开启热点连接暴增>TUN模式，开启热点连接暴增</a></li></ul></li></ul></nav></div></div><div class=content id=content><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden=true></i>注意<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>本文最后更新于 2023-04-03，文中内容可能已过时。</div></div></div><p>2020 年的第一篇博文竟然是讲虚拟砖混结构建筑物逾越技术的，感觉有点微妙。</p><p>年终总结啊，在写了在写了，明年就发。</p><p>因为嫌麻烦，我这几年基本用的都是现成的代理服务（俗称机场）。这样虽然不用担心自己机器 IP 被墙、速度方面基本有保障、节点也多，不过俗话说不要把鸡蛋放在一个篮子里，自建一个代理服务器备用还是很有必要的。</p><p>这几年翻墙技术似乎也发展了不少（是吗？），这次我选择的方法是 V2Ray + WebSocket + TLS + CloudFlare 中转：速度不重要，隐蔽性、抗干扰性第一。这么几层裹上去，除非真的掐网线搞大局域网，不然应该还是能撑个一段时间。</p><p>正文开始前先提个醒，本文不是小白教程，就是随手记录一下，所以我会假定你有一定的基础知识与操作经验。</p><h2 id=1-安装-v2ray>1. 安装 V2Ray</h2><p>除非你是真的小白零经验，或者「能用就好」主义的忠实信奉者，不然我是不推荐你一上来就直接使用网上那些「一键脚本」的。</p><p>就算一键脚本再怎么优秀再怎么便利，至少也应该亲自手动操作一次，了解一下大致的流程。如果我想要做某件事，应该进行哪些操作，脚本会替我完成哪些操作，这些自动化操作是不是符合自己的预期（尤其是脚本是其他人写好的情况下），最起码这些东西得心里有数。</p><p>脚本写出来就是帮我们自动完成一些繁琐的操作的，其存在当然有意义，不然每台机器上都手动操作一遍过去，不得累死？用肯定是要用，我所不赞成的只是在不了解这个脚本的情况下瞎用。</p><p>线上服务器搭建 LNMP 环境时我也经常用 <a href=https://oneinstack.com/ target=_blank rel="external nofollow noopener noreferrer">OneinStack<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a> 这样的一键包，很方便。而且它的源码我也都看过，很清楚它能干嘛、会干嘛。也知道它自带的 <code>vhost.sh</code> 虚拟主机管理脚本虽然看起来挺友好，但其修改出来的东西经常惨不忍睹，所以服务器上 Nginx 的配置我从来不用它，都是自己管理的。</p><p>总的来说就是可以用傻瓜式脚本，但咱也不能真成傻瓜了，对吧。</p><hr><p>好了不说废话，来安装 V2Ray。</p><p>安装方法有很多，这里就直接用官方提供的脚本：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bash &lt;<span class=o>(</span>curl -L -s https://install.direct/go.sh<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><p>脚本会自动安装这些东西：</p><ul><li><code>/usr/bin/v2ray/v2ray</code> V2Ray 程序</li><li><code>/usr/bin/v2ray/v2ctl</code> V2Ray 工具</li><li><code>/etc/v2ray/config.json</code> 配置文件</li><li><code>/usr/bin/v2ray/geoip.dat</code> IP 数据文件</li><li><code>/usr/bin/v2ray/geosite.dat</code> 域名数据文件</li><li><code>/etc/systemd/system/v2ray.service</code> Systemd Service</li><li><code>/etc/init.d/v2ray</code> SysV 启动脚本</li></ul><h2 id=2-配置-v2ray-服务端>2. 配置 V2Ray 服务端</h2><p>虽然严格来说 V2Ray 并不分客户端和服务端……反正就是那个意思啦。</p><p>编辑配置文件 <code>/etc/v2ray/config.json</code>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;inbounds&#34;</span><span class=o>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;port&#34;</span><span class=o>:</span> <span class=mi>10086</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 因为还要用 Nginx 反代，这里直接监听本地就行
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=s2>&#34;listen&#34;</span><span class=o>:</span> <span class=s2>&#34;127.0.0.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;protocol&#34;</span><span class=o>:</span> <span class=s2>&#34;vmess&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;settings&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;clients&#34;</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=c1>// 用户 UUID，自己随机弄一个
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=s2>&#34;id&#34;</span><span class=o>:</span> <span class=s2>&#34;23ad6b10-8d1a-40f7-8ad0-e3e35cd38297&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;level&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;alterId&#34;</span><span class=o>:</span> <span class=mi>64</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;streamSettings&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 指定底层传输方式为 WebSocket
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=s2>&#34;network&#34;</span><span class=o>:</span> <span class=s2>&#34;ws&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;wsSettings&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 在哪个路径上提供 WS 服务，可自定义
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;path&#34;</span><span class=o>:</span> <span class=s2>&#34;/whatever&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}],</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;outbounds&#34;</span><span class=o>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;protocol&#34;</span><span class=o>:</span> <span class=s2>&#34;freedom&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;settings&#34;</span><span class=o>:</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  <span class=p>},{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;protocol&#34;</span><span class=o>:</span> <span class=s2>&#34;blackhole&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;settings&#34;</span><span class=o>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;tag&#34;</span><span class=o>:</span> <span class=s2>&#34;blocked&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}],</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;routing&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;rules&#34;</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 默认规则，禁止访问服务器内网
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;type&#34;</span><span class=o>:</span> <span class=s2>&#34;field&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;ip&#34;</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;geoip:private&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;outboundTag&#34;</span><span class=o>:</span> <span class=s2>&#34;blocked&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>上述配置是直接基于默认配置修改的，V2Ray 的配置很灵活，还有很多可以完善的地方。不过配置调优并不是本文的重点，所以这里按下不表，有兴趣可以自行阅读官方文档。</p><h2 id=3-运行-v2ray>3. 运行 V2Ray</h2><p>配置完了，运行一下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>systemctl start v2ray
</span></span></code></pre></td></tr></table></div></div><p>如果你的服务器不用 Systemd：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>service v2ray start
</span></span><span class=line><span class=cl><span class=c1># 要么</span>
</span></span><span class=line><span class=cl>/etc/init.d/v2ray start
</span></span><span class=line><span class=cl><span class=c1># 或者手动运行</span>
</span></span><span class=line><span class=cl>/usr/bin/v2ray/v2ray -config /etc/v2ray/config.json
</span></span></code></pre></td></tr></table></div></div><p>测试一下有没有跑起来：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -i http://127.0.0.1:10086/whatever
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>HTTP/1.1 400 Bad Request
</span></span><span class=line><span class=cl>Content-Type: text/plain; charset=utf-8
</span></span><span class=line><span class=cl>Sec-Websocket-Version: 13
</span></span><span class=line><span class=cl>X-Content-Type-Options: nosniff
</span></span><span class=line><span class=cl>Date: Sun, 12 Jan 2020 11:45:14 GMT
</span></span><span class=line><span class=cl>Content-Length: 12
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Bad Request
</span></span></code></pre></td></tr></table></div></div><p>注意 curl 访问的端口和路径要和上面 V2Ray 中配置的一致，出现 400 Bad Request 就对了。</p><h2 id=4-配置-nginx>4. 配置 Nginx</h2><p>毕竟要隐蔽嘛，最好是选一个已经上线的正常网站，悄咪咪地把其中一个路径反代到我们的 V2Ray 上。</p><p>网上不少 V2Ray + WebSocket + TLS 的教程里，Web 服务器 + SSL 证书的配置都是重头戏。可如果你平时就有在捣鼓网站的话，这些实在是都不算啥……所以我这里也就一笔带过了。</p><p>以 Nginx 为例，找个合适的 <code>server {}</code> 块添加以下内容（这重定向语法够蛋疼的）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>location</span> <span class=s>/whatever</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_redirect</span> <span class=no>off</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_http_version</span> <span class=mi>1</span><span class=s>.1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>Upgrade</span> <span class=nv>$http_upgrade</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>Connection</span> <span class=s>&#34;upgrade&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>Host</span> <span class=nv>$http_host</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>X-Real-IP</span> <span class=nv>$remote_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_set_header</span> <span class=s>X-Forwarded-For</span> <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>set</span> <span class=nv>$is_v2ray</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>if</span> <span class=s>(</span><span class=nv>$http_upgrade</span> <span class=p>=</span> <span class=s>&#34;websocket&#34;)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>set</span> <span class=nv>$is_v2ray</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>if</span> <span class=s>(</span><span class=nv>$is_v2ray</span> <span class=p>=</span> <span class=mi>1</span><span class=s>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># 仅当请求为 WebSocket 时才反代到 V2Ray
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>proxy_pass</span> <span class=s>http://127.0.0.1:10086</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>if</span> <span class=s>(</span><span class=nv>$is_v2ray</span> <span class=p>=</span> <span class=mi>0</span><span class=s>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># 否则显示正常网页
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>rewrite</span> <span class=s>^/(.*)</span>$ <span class=s>/mask-page</span> <span class=s>last</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>注意 <code>location</code> 的路径要和上面 V2Ray 里配置的一样。</p><p>最后完整的 Nginx 配置大概类似这样：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>listen</span> <span class=mi>443</span> <span class=s>ssl</span> <span class=s>http2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>server_name</span> <span class=s>example.com</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>index</span> <span class=s>index.html</span> <span class=s>index.htm</span> <span class=s>index.php</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>root</span> <span class=s>/data/wwwroot/example</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>ssl_certificate</span> <span class=s>/etc/letsencrypt/live/example.com/fullchain.pem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>ssl_certificate_key</span> <span class=s>/etc/letsencrypt/live/example.com/privkey.pem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>ssl_session_cache</span> <span class=s>shared:SSL:10m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>ssl_session_timeout</span> <span class=mi>10m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>ssl_protocols</span> <span class=s>TLSv1.2</span> <span class=s>TLSv1.3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>ssl_prefer_server_ciphers</span> <span class=no>on</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>ssl_ciphers</span> <span class=s>EECDH+AESGCM:EDH+AESGCM</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=p>~</span> <span class=sr>[^/]\.php(/|$)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>fastcgi_pass</span> <span class=s>unix:/dev/shm/php-cgi.sock</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>fastcgi_index</span> <span class=s>index.php</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>include</span> <span class=s>fastcgi.conf</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=s>/whatever</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1># ...
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>表面看上去像个正常 PHP 网站，<code>/whatever</code> 里才是大有乾坤。</p><p>再把路径和网站内容搞得唬人一点，我寻思隐蔽性方面应该是没问题的。</p><h2 id=5-配置-cloudflare>5. 配置 CloudFlare</h2><p>呃，这个就不用讲什么了吧。还不说声多谢 CloudFlare 哥？</p><p>CDN 配置完了再用 curl 测试一下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -i https://example.com/whatever
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>HTTP/2 400
</span></span><span class=line><span class=cl>date: Sun, 12 Jan 2020 08:44:07 GMT
</span></span><span class=line><span class=cl>content-type: text/plain; charset=utf-8
</span></span><span class=line><span class=cl>content-length: 12
</span></span><span class=line><span class=cl>sec-websocket-version: 13
</span></span><span class=line><span class=cl>x-content-type-options: nosniff
</span></span><span class=line><span class=cl>cf-cache-status: DYNAMIC
</span></span><span class=line><span class=cl>expect-ct: max-age=604800, report-uri=&#34;https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct&#34; server: cloudflare
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Bad Request
</span></span></code></pre></td></tr></table></div></div><p>同样也是出现 400 Bad Request 就对了。</p><p>如果你像我上面一样在 Nginx 中配置了 <code>$http_upgrade = "websocket"</code> 的判断的话，这里返回的会是用于伪装的那个页面（而且 Nginx 的 <code>$http_upgrade</code> 变量不知道是按什么赋值的，直接 <code>curl --header "Upgrade: websocket"</code> 的话还不认，怪得很）。可以使用 <code>wscat</code> 来测试：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wscat -c wss://example.com/whatever
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Connected (press CTRL+C to quit)
</span></span></code></pre></td></tr></table></div></div><h2 id=6-配置-v2ray-客户端>6. 配置 V2Ray 客户端</h2><p>客户端配置文件大概改成这样：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;log&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;loglevel&#34;</span><span class=o>:</span> <span class=s2>&#34;warning&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;inbounds&#34;</span><span class=o>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 本地代理配置
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=s2>&#34;port&#34;</span><span class=o>:</span> <span class=mi>1080</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;listen&#34;</span><span class=o>:</span> <span class=s2>&#34;127.0.0.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;protocol&#34;</span><span class=o>:</span> <span class=s2>&#34;socks&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;settings&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;auth&#34;</span><span class=o>:</span> <span class=s2>&#34;noauth&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;udp&#34;</span><span class=o>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;ip&#34;</span><span class=o>:</span> <span class=s2>&#34;127.0.0.1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}],</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;outbounds&#34;</span><span class=o>:</span> <span class=p>[{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;protocol&#34;</span><span class=o>:</span> <span class=s2>&#34;vmess&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;settings&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;vnext&#34;</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=c1>// 套过 CloudFlare 的网址
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=s2>&#34;address&#34;</span><span class=o>:</span> <span class=s2>&#34;example.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;port&#34;</span><span class=o>:</span> <span class=mi>443</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;users&#34;</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>              <span class=c1>// id 和 alterId 必须和服务端上配置的一样
</span></span></span><span class=line><span class=cl><span class=c1></span>              <span class=s2>&#34;id&#34;</span><span class=o>:</span> <span class=s2>&#34;23ad6b10-8d1a-40f7-8ad0-e3e35cd38297&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=s2>&#34;alterId&#34;</span><span class=o>:</span> <span class=mi>64</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>          <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;streamSettings&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 传输协议为 WebSocket
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=s2>&#34;network&#34;</span><span class=o>:</span> <span class=s2>&#34;ws&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=c1>// 底层传输安全为 TLS
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=s2>&#34;security&#34;</span><span class=o>:</span> <span class=s2>&#34;tls&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;wsSettings&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 路径要和上面设置的一样
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;path&#34;</span><span class=o>:</span> <span class=s2>&#34;/whatever&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}],</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;policy&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;levels&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;0&#34;</span><span class=o>:</span> <span class=p>{</span><span class=s2>&#34;uplinkOnly&#34;</span><span class=o>:</span> <span class=mi>0</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>上述客户端配置同样也是简化的，路由、DNS 什么的都没设置。</p><p>当然，我估计桌面用户基本上用的都是各种图形客户端，不然可不是折腾自己嘛。以 Windows 上的 v2rayN 客户端为例，你可以这样添加服务器：</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://prinsss.github.io/v2ray-ws-tls-cloudflare/v2rayn-client-ws-tls-config.png data-srcset="https://prinsss.github.io/v2ray-ws-tls-cloudflare/v2rayn-client-ws-tls-config.png, https://prinsss.github.io/v2ray-ws-tls-cloudflare/v2rayn-client-ws-tls-config.png 1.5x, https://prinsss.github.io/v2ray-ws-tls-cloudflare/v2rayn-client-ws-tls-config.png 2x" data-sizes=auto alt=v2rayn-client-ws-tls-config title=v2rayn-client-ws-tls-config></p><p>不出意外就可以正常使用了。</p><h2 id=常见问题>常见问题</h2><h3 id=tun模式开启热点连接暴增>TUN模式，开启热点连接暴增</h3><blockquote><ol><li>开启热点分享功能，此时系统网络设置中会生成一个网卡</li><li>开启 TUN 模式</li><li>进入系统网络设置，在 Clash 网卡右键选择属性，选择共享标签页</li><li>勾选“允许其他网络用户通过此计算机的 Internet 连接来连接”</li><li>在“家庭网络连接”选择框中选择第 1 步生成的网卡</li></ol></blockquote><p><a href=https://file.leey.tech/d/OneDrive-P1/2022/04/21/DEycqBZ9/1650554539.jpg title=networdk-adaptor.jpg target=_blank rel="external nofollow noopener noreferrer"><figure><a class=lightgallery href=https://file.leey.tech/d/OneDrive-P1/2022/04/21/DEycqBZ9/1650554539.jpg data-thumbnail=https://file.leey.tech/d/OneDrive-P1/2022/04/21/DEycqBZ9/1650554539.jpg data-sub-html="<h2>networdk-adaptor.jpg</h2><p>networdk-adaptor.jpg</p>"><img class=lazyload src=/svg/loading.min.svg data-src=https://file.leey.tech/d/OneDrive-P1/2022/04/21/DEycqBZ9/1650554539.jpg data-srcset="https://file.leey.tech/d/OneDrive-P1/2022/04/21/DEycqBZ9/1650554539.jpg, https://file.leey.tech/d/OneDrive-P1/2022/04/21/DEycqBZ9/1650554539.jpg 1.5x, https://file.leey.tech/d/OneDrive-P1/2022/04/21/DEycqBZ9/1650554539.jpg 2x" data-sizes=auto alt=networdk-adaptor.jpg title=networdk-adaptor.jpg></a><figcaption class=image-caption>networdk-adaptor.jpg</figcaption></figure><i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></p><p><strong>参考链接：</strong></p><ul><li><a href=https://toutyrater.github.io/advanced/wss_and_web.html target=_blank rel="external nofollow noopener noreferrer">WebSocket+TLS+Web · V2Ray 配置指南|V2Ray 白话文教程<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li><li><a href=https://www.v2ray.com/chapter_02/ target=_blank rel="external nofollow noopener noreferrer">配置文件 · Project V 官方网站<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li><li><a href=https://github.com/233boy/v2ray/wiki/%E4%BD%BF%E7%94%A8Cloudflare%E4%B8%AD%E8%BD%ACV2Ray%E6%B5%81%E9%87%8F target=_blank rel="external nofollow noopener noreferrer">使用Cloudflare中转V2Ray流量 · 233boy/v2ray Wiki<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li><li><a href=https://blog.leey.tech/2022/04/20/cfw-tun-hotspot.html target=_blank rel="external nofollow noopener noreferrer">CFW TUN 模式 移动热点冲突 - Leey&rsquo;s<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="2023-04-03 08:38:32">更新于 2023-04-03&nbsp;<a class=git-hash href=https://github.com/SivanLaai/blog/commit/fdbaa439becfe12e8462b6db9819a2f43386c309 rel="external nofollow noopener noreferrer" target=_blank title="commit by SivanLaai(lyhhap@163.com) fdbaa439becfe12e8462b6db9819a2f43386c309: update passages"><i class="fa-solid fa-hashtag fa-fw" aria-hidden=true></i>fdbaa43</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/technology/lattern/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span><span><a href=https://github.com/SivanLaai/blog/edit/master/content/posts/technology/lattern.md title=编辑此页 target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>编辑此页</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://www.laais.cn/posts/technology/lattern/ data-title="搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare" data-hashtags=V2Ray><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://www.laais.cn/posts/technology/lattern/ data-hashtag=V2Ray><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://www.laais.cn/posts/technology/lattern/ data-title="搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://www.laais.cn/posts/technology/lattern/ data-title="搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare"><i data-svg-src=/lib/simple-icons/icons/line.min.svg aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://www.laais.cn/posts/technology/lattern/ data-title="搭建备用梯子：V2Ray + WebSocket + TLS + CloudFlare"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/v2ray/ class=post-tag>V2Ray</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/research/multiclass_svm/ class=post-nav-item rel=prev title=多分类支持向量机><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>多分类支持向量机</a>
<a href=/posts/projects/rime/info/ class=post-nav-item rel=next title=Rime输入法介绍>Rime输入法介绍<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=waline class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://waline.js.org/ rel="external nofollow noopener noreferrer">Waline</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2018 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=https://www.laais.cn target=_blank rel="external nofollow noopener noreferrer">SivanLaai</a></span></div><div class="footer-line statistics"><span class=site-time title='网站运行中 ...'><i class="fa-solid fa-heartbeat fa-fw animate-icon" aria-hidden=true></i>&nbsp;<span class=run-times>网站运行中 ...</span></span></div><div class="footer-line beian"><a href=https://beian.miit.gov.cn class="icp footer-divider">京ICP备2023014024号-1</a></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/SivanLaai/blog title="在 GitHub 上查看源代码" target=_blank rel="external nofollow" class="github-corner right d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#000;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/waline/waline.css><link rel=stylesheet href=/lib/katex/katex.min.css><script src=/lib/waline/waline.js defer></script><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/lazysizes/lazysizes.min.js async defer></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/katex/katex.min.js defer></script><script src=/lib/katex/auto-render.min.js defer></script><script src=/lib/katex/copy-tex.min.js defer></script><script src=/lib/katex/mhchem.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script src=/lib/cell-watermark/watermark.min.js defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{enable:!0,expired:!1,waline:{copyright:!0,dark:"body[data-theme='dark']",el:"#waline",emoji:["//unpkg.com/@waline/emojis@1.1.0/weibo"],highlighter:!1,imageUploader:!1,lang:"zh-cn",login:"enable",meta:["nick","mail","link"],pageSize:10,pageview:!0,search:!1,serverURL:"https://comment.laais.cn/",texRenderer:!1}},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0,selector:""},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},siteTime:"2018-12-18T16:15:22+08:00",watermark:{appendto:".wrapper>main",colspacing:30,content:'<img class="fixit-icon" src="/safari-pinned-tab.svg" alt="FixIt logo" /> FixIt 主题',enable:!0,fontfamily:"inherit",fontsize:.85,height:21,opacity:.0125,rotate:15,rowspacing:60,width:150}}</script><script src=/js/theme.min.js defer></script></body></html>